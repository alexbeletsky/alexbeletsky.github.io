
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Alexander Beletsky's development blog</title>
  <meta name="author" content="Alexander Beletsky">

  
  <meta name="description" content="Approval Tests, Alternative View on Test Automation Dec 11th, 2011 Approvals, Open source, TDD, Tools Approval Tests or simply Approvals in a &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://beletsky.net/blog/page/10/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/fontello.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/pure-min.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Alexander Beletsky's development blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:800' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-16388698-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>


<body>
	<header class="pure-g-r"><div class="pure-g-r">
	<div class="inner pure-u-1">
		<h4 class="light">Alexander Beletsky's development blog</h4>
		<h1><a href="/">My profession is engineering</a></h1>
		<nav role="navigation" class="pure-menu pure-menu-open pure-menu-horizontal light"><ul>
	<li><a href="/projects">Projects</a></li>
	<li><a href="/talks">Talks</a></li>
	<li><a href="/blog/archives">Archive</a></li>
	<li><a href="/about">About me</a></li>
</ul>

</nav>
	</div>
</div>

</header>
	<div class="social inner pure-menu-horizontal"><ul>
	<li><a class="twitter icon-twitter" href="http://twitter.com/alexbeletsky"></a></li>
	<li><a class="github icon-github-circled" href="https://github.com/alexanderbeletsky"></a></li>
	<li><a class="stackoverflow icon-stackoverflow" href="http://stackoverflow.com/users/386751/alexanderb"></a></li>
	<li><a class="rss icon-rss" href="http://feeds.feedburner.com/abeletskyblog"></a></li>
</ul>
</div>
	<div id="content" class="inner pure-g-r"><div class="blog-index">
  
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/12/approval-tests-alternative-view-on-test.html">
    
      Approval Tests, Alternative View on Test Automation</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-12-11T01:19:00+02:00" pubdate data-updated="true">Dec 11<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/approvals/'>Approvals</a>, <a class='category' href='/blog/categories/open-source/'>Open source</a>, <a class='category' href='/blog/categories/tdd/'>TDD</a>, <a class='category' href='/blog/categories/tools/'>Tools</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p><a href="https://sourceforge.net/projects/approvaltests/">Approval Tests</a> or simply Approvals in a framework created by <a href="http://twitter.com/#!/LlewellynFalco">Llewellyn Falco</a> and <a href="http://dangilkerson.users.sourceforge.net/">Dan Gilkerson</a>, providing support for .NET, Java, PHP and Ruby. It is not yet another unit testing framework like NUnit or MbUnit etc., instead those frameworks are used to run approval tests.<br />
</p><p>Broadly speaking, software is nothing more as virtual box there we put some inputs and expect on outputs. The outputs could be produces by zillion ways. Those ways are differ by its implementation. Unit tests are too much focusing on implementation. Thats why unit tests might fail even if you have working code, or otherwise. Approvals are focusing on output.<br />
</p><h2>How it works?</h2><p>Let&#8217;s take a look on a very simple case. Say, I have a class <code>ShoppingCart</code>. I can add some products inside the shopping cart, confirm my purchase. I expect that total price is calculated for me. <br />
</p><pre class="brush: csharp">[TestFixture]
[UseReporter(typeof(DiffReporter))]
public class ShoppingCartTests {

    [Test]
    public void should_calculate_the_total_price_for_shopping_cart() {
        // do
        var shoppingCart = new ShoppingCart();
        shoppingCart.Add(new Product { Id = "iPad", Price = 500 });
        shoppingCart.Add(new Product { Id = "Mouse", Price = 20 });
        shoppingCart.Confirm();

        // verify
        Approvals.Approve(shoppingCart);
    }
}
</pre><p>What happens if I run this test? If I&#8217;m running it first time it fails. No matter it works or doesn&#8217;t. Framework simply don&#8217;t know that yet. To understand how much correct that code is, it will actually ask you, to utilized human primary power - recognition.   <br />
</p><p>In that case it will open the TortoiseDiff application and show actual and expected outputs.<br />
</p><a href="https://lh5.googleusercontent.com/-la_QjhoPxSc/TuPoxAXVteI/AAAAAAAAH0w/MdWZ0OAcalk/s779/Diff.jpg"><br />
<img src="https://lh5.googleusercontent.com/-la_QjhoPxSc/TuPoxAXVteI/AAAAAAAAH0w/MdWZ0OAcalk/s779/Diff.jpg" /><br />
</a><br />
<p>Here, I&#8217;m able just read that: &#8220;Ok, I have 2 products in my cart..one iPod and one Mouse, iPods costs 500 smth and mouse is 20 smth.. and the total price is 520 - looks good! I approve that result!&#8221;.<br />
</p><p>Technically the approving is just copying actual output file to expected. As soon as test passed, actual file output is deleted and approved file resides near test code file, so you just check it in source control.<br />
</p><p>If then the shopping cart is modified and something goes wrong. There would be a failure. In case of unit tests, that would be multiple failure of different cases and it might be not so easy to understand what&#8217;s exactly wrong. For approval test, it would be one failure. And the cool thing that I have a difference that shows there exactly the deviation is. <br />
</p><a href="https://lh3.googleusercontent.com/-CTO2HOQGoDs/TuPo7nJ1U8I/AAAAAAAAH04/ycao7SUf78s/s720/Diff2.jpg"><br />
<img src="https://lh3.googleusercontent.com/-CTO2HOQGoDs/TuPo7nJ1U8I/AAAAAAAAH04/ycao7SUf78s/s720/Diff2.jpg" /><br />
</a><br />
<h2>Where it works?</h2><p>It is not only the simple objects you can approve. What&#8217;s the cool thing, you can approval against the different sources: objects, enumerables, files, HTML, XML etc. On a more high level: WpfForm, WinForm, ASP.NET Page. <br />
</p><p>For instance, code for ASP.NET:<br />
</p><pre class="brush: csharp">[Test]
public void should_have_approved_layout() {
    ApprovalTests.Asp.Approvals.ApproveUrl("http://localhost:62642/customer/");
}
</pre><p>Or for WPF form<br />
</p><pre class="brush: csharp">[Test]
public void should_have_approved_layout() {
    ApprovalTests.Wpf.Approvals.Approve(new Form());
}
</pre><p>With WPF and Win forms is that it&#8217;s able to serialize them into images, so the actual and expected results are actually images, so it is easy to track the differences (TortoiseDiff can do that).<br />
</p><h2>When it works?</h2><p>It works best when you deal with 2 things: UI and legacy code.<br />
</p><p>Testing of UI is always a difficult part. But what you typically need is: make sure that UI is not changed and if changed, where exactly is happening. Apporvals solves that nicely. It is only one line of code test, to test ASP.NET page for instance. <br />
</p><p>Legacy is another story: you have no tests there at all, but you have to change code to implement new feature or refactor. The interesting thing about legacy code - It works! It works for years, no matter how it written (remember, virtual box). And this is a very great advantage of that code. With approvals, with only one test you can get all possible outputs (HTML, XLM, JSON, SQL or whatever output it could be) and approve, because you know - it works! After you have such test and approved result you are really much safe with a refactoring, since now you &#8220;locked down&#8221; all existing behavior.<br />
</p><p>Approvals are not something you need to run all the time, like units or integration tests. It more like handy tool. You create approval tests, you do your job and at the end of the day it might happen - you no longer needed, so you can just throw it away.<br />
</p><h2>Want to hear more?</h2><p>Just go and listen to <a href="http://herdingcode.com/?p=329">this</a> Herding Code podcast episode, or visit project <a href="https://sourceforge.net/projects/approvaltests/">web site</a> or join me at 17 December on <a href="http://xpdays.com.ua/program/">XP Days Ukraine</a> conference in Kiev, where I&#8217;m going to have a speech dedicated to Approvals.<br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/12/inside-aspnet-mvc-instantiation-of.html">
    
      Inside ASP.NET MVC: Instantiation of Controller</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-12-05T21:05:00+02:00" pubdate data-updated="true">Dec 5<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/insidemvc/'>InsideMVC</a>, <a class='category' href='/blog/categories/mvc/'>MVC</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>Controller are being created by <code>ControllerFactory</code>, by default <code>IControllerFactory</code> type is being resolved to <code>DefaultControllerFactory</code>. Today&#8217;s post is dedicated to some details of how actually <code>DefaultControllerFactory</code> works and creates instance of required controller. Let&#8217;s go from the beginning!<br />
</p><h2>Request for controller instance</h2><p>Initially, we are at <a href="http://www.beletsky.net/2011/06/inside-aspnet-mvc-all-begins-here.html">MvcHandler</a>&#8217;s <code>ProcessRequestInit</code> method, where we extract controllers name from RouteData and request controller factory to create corresponding controller.<br />
</p><pre class="brush: csharp">private void ProcessRequestInit(HttpContextBase httpContext, out IController controller, out IControllerFactory factory) {
 // If request validation has already been enabled, make it lazy. This allows attributes like [HttpPost] (which looks
 // at Request.Form) to work correctly without triggering full validation.
 bool? isRequestValidationEnabled = ValidationUtility.IsValidationEnabled(HttpContext.Current);
 if (isRequestValidationEnabled == true) {
  ValidationUtility.EnableDynamicValidation(HttpContext.Current);
 }

 AddVersionHeader(httpContext);
 RemoveOptionalRoutingParameters();

 // Get the controller type
 string controllerName = RequestContext.RouteData.GetRequiredString(&quot;controller&quot;);

 // Instantiate the controller and call Execute
 factory = ControllerBuilder.GetControllerFactory();
 controller = factory.CreateController(RequestContext, controllerName);
 if (controller == null) {
  throw new InvalidOperationException(
   String.Format(
    CultureInfo.CurrentCulture,
    MvcResources.ControllerBuilder_FactoryReturnedNull,
    factory.GetType(),
    controllerName));
 }
}
</pre><h2>DefaultControllerBuilder internals<br />
</h2><p><code>CreateController</code> is rather elegant method, basically it does some arguments check&#8217;s, resolve the controller type by it&#8217;s name and then call to <code>GetControllerIntance</code> to instantiate that type.<br />
</p><pre class="brush: csharp">public virtual IController CreateController(RequestContext requestContext, string controllerName) {
 if (requestContext == null) {
  throw new ArgumentNullException(&quot;requestContext&quot;);
 }
 if (String.IsNullOrEmpty(controllerName)) {
  throw new ArgumentException(MvcResources.Common_NullOrEmpty, &quot;controllerName&quot;);
 }
 Type controllerType = GetControllerType(requestContext, controllerName);
 IController controller = GetControllerInstance(requestContext, controllerType);
 return controller;
}
</pre><h2>Getting the controller type</h2><p><code>GetControllerType</code> is delegating it&#8217;s call to internal <code>GetControllerTypeWithinNamespaces</code>. It receives Route, Controller&#8217;s name and Namespaces.  <br />
</p><pre class="brush: csharp">private Type GetControllerTypeWithinNamespaces(RouteBase route, string controllerName, HashSet&lt;string&gt; namespaces) {
 // Once the master list of controllers has been created we can quickly index into it
 ControllerTypeCache.EnsureInitialized(BuildManager);

 ICollection&lt;Type&gt; matchingTypes = ControllerTypeCache.GetControllerTypes(controllerName, namespaces);
 switch (matchingTypes.Count) {
  case 0:
   // no matching types
   return null;

  case 1:
   // single matching type
   return matchingTypes.First();

  default:
   // multiple matching types
   throw CreateAmbiguousControllerException(route, controllerName, matchingTypes);
 }
}
</pre><p>The namespaces parameter are quite important. If you remember, you can explicitly mention the namespace during the route definition, with overloaded MapRoute method:<br />
</p><pre class="brush: csharp">public static Route MapRoute(this RouteCollection routes, string name, string url, string[] namespaces) {
 return MapRoute(routes, name, url, null /* defaults */, null /* constraints */, namespaces);
}
</pre><p>Namespaces parameter then being stored to Route.DataTokens[&#8220;Namespaces&#8221;]. Namespaces parameter matters, then you have controllers with same names. This is in particular makes sense then you have different areas.<br />
</p><h2>Caching Controller Types</h2><p>The interesting thing is that framework not re-reads types for each request, that would be just to expesive, but instead it uses a cache which is initialized at the very first request and used at the life time of application. The call <code>ControllerTypeCache.EnsureInitialized(BuildManager);</code> makes sure that cache is in actual state. How does MVC caching the types?<br />
</p><p>Very simple and straight forward solution - in .XML file.<br />
</p><pre class="brush:csharp">public static List&lt;Type&gt; GetFilteredTypesFromAssemblies(string cacheName, Predicate&lt;Type&gt; predicate, IBuildManager buildManager) {
 TypeCacheSerializer serializer = new TypeCacheSerializer();

 // first, try reading from the cache on disk
 List&lt;Type&gt; matchingTypes = ReadTypesFromCache(cacheName, predicate, buildManager, serializer);
 if (matchingTypes != null) {
  return matchingTypes;
 }

 // if reading from the cache failed, enumerate over every assembly looking for a matching type
 matchingTypes = FilterTypesInAssemblies(buildManager, predicate).ToList();

 // finally, save the cache back to disk
 SaveTypesToCache(cacheName, matchingTypes, buildManager, serializer);

 return matchingTypes;
}
</pre><p>It try&#8217;s read cache from file, if there are not matching types there it would try to read assemblies and then store it to cache. You might be interested where this file is actually located, so take a look:<br />
</p><a href="https://lh4.googleusercontent.com/-UkykIJvxzV8/Tt0WMwVDXsI/AAAAAAAAH0o/hgnCXDEYvmY/s848/code_1.jpg"><br />
<img src="https://lh4.googleusercontent.com/-UkykIJvxzV8/Tt0WMwVDXsI/AAAAAAAAH0o/hgnCXDEYvmY/s848/code_1.jpg" alt="cache file name" /><br />
</a><br />
<p>And for the most curious guys, here is the content:<br />
</p><pre class="brush: xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;!--This file is automatically generated. Please do not modify the contents of this file.--&gt;
&lt;typeCache lastModified=&quot;14.10.2011 19:33:03&quot; mvcVersionId=&quot;aa5414f4-4d8e-4f2a-a98b-7334bf15d104&quot;&gt;
  &lt;assembly name=&quot;MvcForDebug2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&quot;&gt;
    &lt;module versionId=&quot;1ad99820-dc17-4be0-9f56-6dd2bdcd7950&quot;&gt;
      &lt;type&gt;MvcForDebug2.Controllers.HomeController&lt;/type&gt;
    &lt;/module&gt;
  &lt;/assembly&gt;
&lt;/typeCache&gt;
</pre><p><code>FilterTypesInAssemblies</code> method tries to get all controllers it can. What it does, it goes throught all referenced assemblies and using special predicate class matching the types. <br />
</p><pre class="brush:csharp">private static IEnumerable&lt;Type&gt; FilterTypesInAssemblies(IBuildManager buildManager, Predicate&lt;Type&gt; predicate) {
 // Go through all assemblies referenced by the application and search for types matching a predicate
 IEnumerable&lt;Type&gt; typesSoFar = Type.EmptyTypes;

 ICollection assemblies = buildManager.GetReferencedAssemblies();
 foreach (Assembly assembly in assemblies) {
  Type[] typesInAsm;
  try {
   typesInAsm = assembly.GetTypes();
  }
  catch (ReflectionTypeLoadException ex) {
   typesInAsm = ex.Types;
  }
  typesSoFar = typesSoFar.Concat(typesInAsm);
 }
 return typesSoFar.Where(type =&gt; TypeIsPublicClass(type) &amp;&amp; predicate(type));
}
</pre><p>So, the last interesting thing here is the predicate that actually used:<br />
</p><pre class="brush:csharp">internal static bool IsControllerType(Type t) {
 return
  t != null &amp;&amp;
  t.IsPublic &amp;&amp;
  t.Name.EndsWith(&quot;Controller&quot;, StringComparison.OrdinalIgnoreCase) &amp;&amp;
  !t.IsAbstract &amp;&amp;
  typeof(IController).IsAssignableFrom(t);
}
</pre><p>You can see, it tries to match any public, ends with &#8220;Controller&#8221; not abstract and implementing <code>IController</code> interface. That&#8217;s why important do not forget to call all your controller with &#8220;Controller&#8221; suffix (yes, I did that mistake several times in the beginning of my MVC journey).<br />
</p><p>Note, that if you have 2 controllers with same names in different namespaces, but did not provide namespace constraint you will have several <code>matchingTypes</code>, so the <code>CreateAmbiguousControllerException</code> will be thrown. I believe each of us seen that kind of exception at least once.<br />
</p><h2>Instantiating the Type</h2><p>As we go a little back and check the code of <code>CreateController</code>: now, we&#8217;ve got the type (or null if type has not been resolved). Next thing is to instantiate it. Nothing really fancy here:<br />
</p><pre class="brush:csharp">protected internal virtual IController GetControllerInstance(RequestContext requestContext, Type controllerType) {
 if (controllerType == null) {
  throw new HttpException(404,
   String.Format(
    CultureInfo.CurrentCulture,
    MvcResources.DefaultControllerFactory_NoControllerFound,
    requestContext.HttpContext.Request.Path));
 }
 if (!typeof(IController).IsAssignableFrom(controllerType)) {
  throw new ArgumentException(
   String.Format(
    CultureInfo.CurrentCulture,
    MvcResources.DefaultControllerFactory_TypeDoesNotSubclassControllerBase,
    controllerType),
   &quot;controllerType&quot;);
 }
 return ControllerActivator.Create(requestContext, controllerType);
}
</pre><p>If everything is all right with controller type it ask ControllerActivator to create the instance. In default case, ControllerActivator is <code>DefaultControllerActivator</code>:<br />
</p><pre class="brush:csharp">public IController Create(RequestContext requestContext, Type controllerType) {
 try {
  return (IController)(_resolverThunk().GetService(controllerType) ?? Activator.CreateInstance(controllerType));
 }
 catch (Exception ex) {
  throw new InvalidOperationException(
   String.Format(
    CultureInfo.CurrentCulture,
    MvcResources.DefaultControllerFactory_ErrorCreatingController,
    controllerType),
   ex);
 }
}
</pre><p>As for the rest of MVC entities it would use <code>IDependencyResolver</code> to resolve that type. <code>IDependecyResolved</code> is detailed <a href="http://www.beletsky.net/2011/10/inside-aspnet-mvc-idependencyresolver.html">here</a>, but as you remember by default at the very end it calls <code>Activator.CreateInstance(type)</code> method.<br />
</p><h2>Conclusions</h2><p>New controller is instantiated on each HTTP request. The instantiation is in-directed, means first we retrieve Type, after creating Instance. The type is being searched dynamically by getting out reflection information from assemblies. To optimize the performance of ASP.NET MVC application, the internal cache of types is used. The cache is stored in file in &#8220;Temporary ASP.NET Files\root\cdd53039\36a27802\UserCache\MVC-ControllerTypeCache.xml&#8221; folder. Namespaces of controllers are matters, in case of two or more controllers has the same name but different namespaces the exception would be thrown. In case of controller type could not be resolved, the HTTP 404 response is generated. Otherwise, the controller instance would be created by <code>IControllerActivator</code> instance.<br />
</p><p>Previous post: <a href="http://www.beletsky.net/2011/10/inside-aspnet-mvc-idependencyresolver.html">Inside ASP.NET MVC: IDependencyResolver - Service locator in MVC</a><br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/12/kiev-altnet-community-thoughts.html">
    
      Kiev ALT.NET Community Thoughts</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-12-03T11:52:00+02:00" pubdate data-updated="true">Dec 3<span>rd</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/kievaltnet/'>KievAltNet</a>, <a class='category' href='/blog/categories/mind/'>Mind</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>I&#8217;ve just reviewed blog posts I created thought that year and realized that I miss very important piece of information here. Something that literally changed my developers life. And I&#8217;m talking about <a href="http://kievalt.net/">Kiev ALT.NET</a> community.<br />
</p><p>From my first join at the beginning of the year I amazed with very cool and friendly atmosphere there. I tried to visit every meeting and each of them brought some value for me. And the most valuable asset I got there is people I met. Those guys simply rock.<br />
</p><a href="https://lh4.googleusercontent.com/-3_a5l569SpU/TtnvsnVAekI/AAAAAAAAH0g/gQeYOduVHZM/s512/kiev.jpg"><br />
<img src="https://lh4.googleusercontent.com/-3_a5l569SpU/TtnvsnVAekI/AAAAAAAAH0g/gQeYOduVHZM/s512/kiev.jpg" alt="kiev alt.net" /><br />
</a><br />
<p><a href="http://twitter.com/chaliy">Mike Chaliy</a>, the leader of community does exceptional job. I could imagine how hard could it be to do all organization work and he does that very well. <br />
</p><p>What&#8217;s important, Mike involved me to do my own speech. I remember that first time when I was sharing my experience with <a href="http://www.beletsky.net/2011/05/continuous-production-make-it-work.html">Continues Deployment</a> based on Chuck Norris tools and Jenkins. That was a good start and I did several more speeches after. I would say it happened only because of Kiev ALT.NET.<br />
</p><p>Getting of knowledge for me is not only books, podcasts and just coding practice. But also, discussions, questions and speeches. I this is definitely productive way of learning. <br />
</p><p>So, I&#8217;m very thankful to Kiev ALT.NET for that positive feel of progress, pleasure of communication with smart guys and fun time of after parties.I wish a long life for community and try to help it as much as I can.<br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/11/develop-with-tests.html">
    
      Develop With Tests</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-11-16T18:10:00+02:00" pubdate data-updated="true">Nov 16<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/tdd/'>TDD</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>I&#8217;ve been recently thinking about my TDD and I came to interesting conclusion.  I&#8217;m not TDD practitioner any more!<br />
</p><p>TDD is quite strict  practice, it suppose you following certain rules. The main rule is test first. You create test, you create code after. For years I&#8217;ve been using that practice as dogma. I&#8217;ve seen a lot of value with such approach and that worked for me really much. <br />
</p><p>Do you use that rules now? Not always.. Do you use something different than TDD? Yes, I do <strong>develop with tests</strong>.<br />
</p><p>See, TDD main power is not in tests itself. The power of TDD is Test Driven Design. This is design that makes code more readable and maintainable. Tests of cause helps regression and general quality, but it is not always the truth. As long as you practice TDD much you feel how designed for tests code should look like. You do not need to create test to prove that code is testable. Following very simple rules you simply guarantee that tests are possible here. <br />
</p><p>Now, I simply optimize the process a bit. I could skip first step and go ahead for code. That does not mean I&#8217;m skipping test. No, I&#8217;ll create there I feel it necessary.. And I feel that mostly to all code I create. But this is no longer TDD, I call that develop with tests. DWT as you want ;)<br />
</p><a href="https://lh3.googleusercontent.com/-wRTF3X1cJm0/TsPgJH6ryEI/AAAAAAAAH0M/H51scOr_Gf8/s620/dwt.jpg"><br />
<img src="https://lh3.googleusercontent.com/-wRTF3X1cJm0/TsPgJH6ryEI/AAAAAAAAH0M/H51scOr_Gf8/s620/dwt.jpg" alt="develop with tests" /><br />
</a><br />
<p>I think a some developers might say, &#8220;Oh, I&#8217;m using DWT as well&#8221;. Others will say, &#8220;I will use DWT since TDD is boring and requires too much time&#8221;. Please do not do that. I strongly believe that is TDD that could make you stronger as developers and your code robust and good looking. So follow the rules before you absolutely sure, you ready to break them.<br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/11/its-writing-time.html">
    
      It&#8217;s Writing Time</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-11-14T10:10:00+02:00" pubdate data-updated="true">Nov 14<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/mind/'>Mind</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>There are great series of stories called <a href="http://en.wikipedia.org/wiki/Azazel_(Asimov)">&#8220;Azazel&#8221;</a> by <a href="http://en.wikipedia.org/wiki/Isaac_Asimov">Isaac Asimov</a>. They are about 2 cm demon named Azazel and George, guy who is able to talk to him. Azazel knows actually nothing about demons or angels, hell or haven.. But he understands the nature of things able to change them. The stories are short and fun and smart, so I would recommend it to read.<br />
</p><p>In particular, there is one great story called &#8220;Writing time&#8221;. It&#8217;s about the man whose name is Mordehai and he is writer. He has a great issue. He always need to wait for something, like wait for doctors, waiters, cab drivers, wait in a shop lines etc. Mordehai treated that time as completely wasted, because he could not spent it for job.<br />
</p><p>He shared that problem with George. George asked Azazel if it&#8217;s possible to help to poor Mordehai. As always Azazel was angry about peoples misery, but agreed to help. He could introduce change that make it possible to Mordehai never need to wait for somebody. That change required a little cost, literally the sun will stop shining in 2 million years earlier, but who cares.<br />
</p><p>George met Mordehai again in several month. For his great disappointment, writer created simply nothing in that time! Not even a small story. Instead of being hyper productive he became non productive at all.<br />
</p><p>How could it be, that person who spend all his time for work are not able to do the work? As Mordehai understood as he sat behind his type writer - he had no ideas. Simply, he don&#8217;t know what to write about. <br />
</p><p>As it turned out all that time he waited actually spent for thinking. It was absolutely not a waste for him, otherwise it was the most productive time.. But he did not realized that before. Unfortunately, Mordehai&#8217;s career totally ruined. <br />
</p><p>You know what? I think that I&#8217;m wasting the time instead of doing &#8220;cool things&#8221;. I work as hard as I can, but the results aren&#8217;t impressive. I neither could find good idea nor have good rest recently - I&#8217;m exactly like Mordehai who blames waiting line for his problems.<br />
</p><p>I&#8217;ll try not to repeat this issue. Having a rest, spending time with family or sport activities are equally important as job (perhaps even more important). And even if you are &#8220;doing nothing&#8221;, something is still going on your head. If inputs are right, outputs will be right as well.. Sooner or later.<br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/11/sayonara-nippon.html">
    
      Sayonara Nippon</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-11-12T21:34:00+02:00" pubdate data-updated="true">Nov 12<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/life/'>Life</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>I&#8217;ve just got back from the most wonderful country I ever been to - Japan. <br />
</p><a href="https://lh5.googleusercontent.com/-JQHNK-xBJqE/Tr7JuF_SRNI/AAAAAAAAHzk/UsxHzEvgek8/s620/Gates.jpg?gl=UA"><br />
<img src="https://lh5.googleusercontent.com/-JQHNK-xBJqE/Tr7JuF_SRNI/AAAAAAAAHzk/UsxHzEvgek8/s620/Gates.jpg?gl=UA" alt="japan gates" /><br />
</a><br />
<p>Japan is really different from everything I got used to. Differences are everywhere, from traffic direction to people behavior. But in general Japan is well developed, high cultural country with interesting history.<br />
</p><p>Tokyo is huge, but the same is <a href="http://www.tokyometro.jp/en/">Tokyo Metropolitan</a> which is really complex, but makes travel from one part of city to another very fast. First day we have a lot of problems to understand metropolitan labyrinths, but with a little practice it does not look so scary anymore. Btw, I&#8217;ve never seen very over crowded stations and trains, even if you travel in rush hour. Comparing to Kyiv metro, Tokyo one is very expensive, where you pay as much as you go.  <br />
</p><a href="https://lh4.googleusercontent.com/-MSLfarHSstA/Tr7Jv5PqImI/AAAAAAAAHzs/nSskJV4W5Ac/s620/metro.JPG?gl=UA"><br />
<img src="https://lh4.googleusercontent.com/-MSLfarHSstA/Tr7Jv5PqImI/AAAAAAAAHzs/nSskJV4W5Ac/s620/metro.JPG?gl=UA" alt="tokyo metropolitan" /><br />
</a><br />
<p>People there are very kind, ready to help you. But the problem is communication. Very few Japanese can speak English. Usual dialog is something like. &#8220;Do you speak English?&#8221;, &#8220;A little..&#8221; and then nothing, even if you try to use as elementary words as possible. So, language barrier is very high. But as soon as they understood your problem, be sure you gonna get help. Once we&#8217;ve lost in metropolitan and one lady went out from station with ask, contacted metropolitan officer and explained our further actions. Such scenario happened several times.<br />
</p><a href="https://lh6.googleusercontent.com/-Yzz0uvSJ0Rc/Tr7JtvG9fkI/AAAAAAAAHzc/Vh8w20Qfjbc/s620/food.JPG?gl=UA"><br />
<img src="https://lh6.googleusercontent.com/-Yzz0uvSJ0Rc/Tr7JtvG9fkI/AAAAAAAAHzc/Vh8w20Qfjbc/s620/food.JPG?gl=UA" alt="noodles" /><br />
</a><br />
<p>Food is very delicious and relatively not expensive. Chinese and Japanese dishes are usually available together in restaurants. But if you want to go with sushi, you have to find specialized one. There are absolutely not a problem to eat in Tokyo. In each corner you could find small restaurants and cafeterias where you will be able to find what you like. Food is available mostly everywhere, including metro stations.     <br />
</p><a href="https://lh6.googleusercontent.com/-oPJTvUilLkA/Tr7JxUvajTI/AAAAAAAAHz0/ipwdXzxSFcE/s620/tree.JPG?gl=UA"><br />
<img src="https://lh6.googleusercontent.com/-oPJTvUilLkA/Tr7JxUvajTI/AAAAAAAAHz0/ipwdXzxSFcE/s620/tree.JPG?gl=UA" alt="tokyo park" /><br />
</a><br />
<p>Tokyo is concrete and wires jungle, but there are several great parks inside. They are beauty and calm. It is easy to find a bench to sit and observe spectacular views. It is great to relax body and mind there.<br />
</p><p>I would not say I&#8217;ve seen a lot, but I really enjoyed with everything I saw. <br />
</p><p>Sayonara Nippon! Hope to visit you again in a while.. Best luck to you!<br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/10/using-ninjectmvc-for-better-aspnet-mvc.html">
    
      Using Ninject.MVC For Better ASP.NET MVC Integration</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-10-31T16:42:00+02:00" pubdate data-updated="true">Oct 31<span>st</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/mvc/'>MVC</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>After the ASP.NET MVC infrastructure is <a href="http://www.beletsky.net/2011/10/integrating-aspnet-mvc-into-legacy-web.html">ready</a>, next logical step it to setup IoC container for application. Ninject setup is easy task, usually you solve that by implementation of your own <a href="http://www.beletsky.net/2011/07/inside-aspnet-mvc-controllerbuilder.html">ControllerFactory</a> and put it to <a href="http://www.beletsky.net/2011/07/inside-aspnet-mvc-controllerbuilder.html">ControllerBuilder</a>. As soon it is good enough approach it does not solve some important MVC implications, like injection of prosperities into filters. To make our lives a little easier Ninject team released <a href="https://github.com/ninject/ninject.web.mvc">Ninject.Web.MVC</a> extension library that solves a lot of similar problems.<br />
</p><h2>Getting binaries</h2><p>Just follow the github to <a href="https://github.com/ninject/ninject.web.mvc/downloads">download</a> latest version of Ninject.Web.MVC and place it to web site <code>/Bin</code> directory. No changes to <code>web.config</code> or something.<br />
</p><h2>Tweaking global.asax</h2><p>Now, let&#8217;s change <code>global.asax</code> according to Ninject.Web.MVC guidelines. I&#8217;ll just show how my current <code>global.aspx</code> looks like:<br />
</p><pre class="brush: xml">&lt;%@ Application Language='C#' Inherits=&quot;Ninject.Web.Mvc.NinjectHttpApplication&quot; %&gt;
&lt;%@ Import Namespace=&quot;Ninject&quot; %&gt;

&lt;script RunAt=&quot;server&quot;&gt;
 public void Application_Start()
 {

 }

 protected override void OnApplicationStarted()
 {
  AreaRegistration.RegisterAllAreas();
 }
 
 protected override IKernel CreateKernel()
 {
  var kernel = new StandardKernel();
  Sba.Web.Infrastructure.RegisterServices.For(kernel);
  
  return kernel;
 }

 public void Application_End()
 {
 }

 public void Application_Error(object sender, EventArgs args)
 {
 }
&lt;/script&gt;
</pre><p>So, we basically inherit from <code>NinjectHttpApplication</code> class and override <code>CreateKernel()</code> method. You can see that inside the method I do call to <code>RegisterServices</code> - it is nothing more as static class, with <code>For</code> method that actually do the registration. Here is example:<br />
</p><pre class="brush: csharp">using Ninject;
using Ninject.Web.Mvc;
using Sba.Common.Repositories;
using Sba.Sales.Models;
using Sba.Sales.Repositories;
using Sba.Sales.Repositories.ViewHandlerRepositories;

namespace Sba.Web.Infrastructure
{
 public class RegisterServices
 {
  public static void For(IKernel kernel)
  {
   kernel.Bind&lt;ISessionLoader&gt;().To&lt;LazySessionLoader&gt;();
   kernel.Bind&lt;ILazyLoadChecker&gt;().To&lt;NHibernateLazyLoadChecker&gt;();
   kernel.Bind&lt;IDraftInvoicesRepository&gt;().To&lt;DraftInvoicesRepository&gt;();
   kernel.Bind&lt;IDraftInvoiceLinesRepository&gt;().To&lt;DraftInvoiceLinesRepository&gt;();
   kernel.Bind&lt;IPaymentTermsRepository&gt;().To&lt;PaymentTermsRepository&gt;();
   kernel.Bind&lt;IUnitsRepository&gt;().To&lt;UnitsRepository&gt;();
   kernel.Bind&lt;ICustomersRepository&gt;().To&lt;CustomersRepository&gt;();
  }
 }
}
</pre><h2>Injection the properties into filters</h2><p>The main advantage of <code>NinjectHttpApplication</code> class usage, that now it handles the injection in different MVC entities by itself. For instance if you need inject to filter:<br />
</p><pre class="brush: csharp">using System.Web.Mvc;
using Ninject;
using Economic2.Core;
using Sba.Common.Repositories;

namespace Sba.Common.Infrastructure.Filters
{
 public class SbaAuthorizeAttribute : AuthorizeAttribute
 {
  [Inject]
  public ISessionLoader SessionLoader { get; set; }

  public override void OnAuthorization(AuthorizationContext filterContext)
  {
            // some authorization logic here..
  }
 }
}
</pre></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/10/integrating-aspnet-mvc-into-legacy-web.html">
    
      Integrating ASP.NET MVC Into Legacy Web Site</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-10-30T09:05:00+02:00" pubdate data-updated="true">Oct 30<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/mvc/'>MVC</a>, <a class='category' href='/blog/categories/tips/'>Tips</a>, <a class='category' href='/blog/categories/asp-dot-net/'>asp.net</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>For some quite long time I naively thought that it is not possible (or at least very difficult) to make ASP.NET MVC stuff work on a Web Site project. But, my latest <a href="http://www.beletsky.net/search/label/InsideMVC">hacking of MVC</a> opened another perspectives. There are no any difficulties with ASP.NET MVC on Web Sites. I&#8217;ll share an experience of integration ASP.NET MVC in my work project legacy Web Site.<br />
</p><h2>Pre-conditions</h2><p>In my case I integrated ASP.NET MVC2, since we are still running on .NET 3.5. If you are running .NET 4.0 the best is to go with ASP.NET MVC3 already. The difference of setup would not be huge, just in proper versions of assemblies.<br />
</p><p>I assume you already have ASP.NET MVC2 framework on your machine (if you have VS2010 - you definitely have one), if no just go that <a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=22079">link</a> and install it.<br />
</p><h2>Web config changes</h2><p>MVC assembly have to be added to <code>web.config</code>. Since the MVC infrastructure heavily depends on Routing mode, it have to be put to <code>web.config</code> as well.<br />
</p><p>Register MVC assemblies:<br />
</p><pre class="brush: xml">&lt;compilation defaultLanguage=&quot;c#&quot; debug=&quot;true&quot;&gt;
 &lt;assemblies&gt;
  &lt;add assembly=&quot;System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089&quot;/&gt;
  &lt;add assembly=&quot;System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35&quot;/&gt;
  &lt;add assembly=&quot;System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089&quot;/&gt;
  &lt;add assembly=&quot;System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089&quot;/&gt;
  &lt;add assembly=&quot;System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A&quot;/&gt;

  &lt;!-- Your application specific assemblies--&gt;
        ...

  &lt;!-- ASP.NET MVC --&gt;
  &lt;add assembly=&quot;System.Web.Abstractions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35&quot;/&gt;
  &lt;add assembly=&quot;System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35&quot;/&gt;
  &lt;add assembly=&quot;System.Web.Mvc, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35&quot;/&gt;
 &lt;/assemblies&gt;
&lt;/compilation&gt;
</pre><p>Namespaces:<br />
</p><pre class="brush: xml">&lt;pages enableViewStateMac=&quot;false&quot; enableViewState=&quot;false&quot; validateRequest=&quot;true&quot; viewStateEncryptionMode=&quot;Never&quot;&gt;
  &lt;controls&gt;
    &lt;add tagPrefix=&quot;asp&quot; namespace=&quot;System.Web.UI&quot; assembly=&quot;System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35&quot;/&gt;
    &lt;add tagPrefix=&quot;asp&quot; namespace=&quot;System.Web.UI.WebControls&quot; assembly=&quot;System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35&quot;/&gt;
  &lt;/controls&gt;
  
  &lt;-- ASP.NET MVC --&gt;
  &lt;namespaces&gt;
    &lt;add namespace=&quot;System.Web.Mvc&quot;/&gt;
    &lt;add namespace=&quot;System.Web.Mvc.Ajax&quot;/&gt;
    &lt;add namespace=&quot;System.Web.Mvc.Html&quot;/&gt;
    &lt;add namespace=&quot;System.Web.Routing&quot;/&gt;
    &lt;add namespace=&quot;System.Linq&quot;/&gt;
    &lt;add namespace=&quot;System.Collections.Generic&quot;/&gt;
    &lt;add namespace=&quot;Microsoft.Web.Mvc&quot;/&gt;
  &lt;/namespaces&gt;
&lt;/pages&gt;
</pre><p>Register URLRouting module and handler.<br />
</p><pre class="brush: xml">&lt;system.webServer&gt;
  &lt;validation validateIntegratedModeConfiguration=&quot;false&quot;/&gt;
  &lt;modules&gt;
 ...
 
 &lt;!-- ASP.NET MVC --&gt;
    &lt;add name=&quot;UrlRoutingModule&quot; type=&quot;System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35&quot; /&gt;
  &lt;/modules&gt;
  &lt;handlers&gt;
    ...
 
 &lt;!-- ASP.NET MVC --&gt;
    &lt;add name=&quot;UrlRoutingHandler&quot; preCondition=&quot;integratedMode&quot; verb=&quot;*&quot; path=&quot;UrlRouting.axd&quot; type=&quot;System.Web.HttpForbiddenHandler, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot; /&gt;
  &lt;/handlers&gt;
&lt;/system.webServer&gt;
</pre><h2>Global.asax changes</h2><p>You would be probably have <code>global.asax</code> without code-behind class. It&#8217;s not a problem, all you need is slightly change the <code>Application_Start()</code> method. Basically you can go and register routes there, as you do in any ASP.NET MVC application. But I didn&#8217;t do that. Instead, I used the advantages of <a href="http://msdn.microsoft.com/en-us/library/ee671793.aspx">Areas</a> feature of MVC2, since it makes better logical grouping. So, my <code>global.asax</code> are:<br />
</p><pre class="brush: csharp">public void Application_Start()
{
 AreaRegistration.RegisterAllAreas();
}
</pre><h2>Models, Views, Controllers</h2><p>In typical ASP.NET MVC application you have 3 folders, for - Models, Views, Controllers. Models/Controllers are C# code, views are .aspx pages. With a Web Site you typically place code into <code>App_Code</code> folder. But you should not do that. Instead, it it better to create a separate class library project that would hold your models and controllers. Views would be placed under corresponding Area folder.<br />
</p><h2>New project for Models/Controllers</h2><p>Just create a new class library project with such folder structure:<br />
</p><a href="https://lh4.googleusercontent.com/-ny77OywB_Pk/Tqz2RrcVfCI/AAAAAAAAHnM/P2Awn0D79zc/s391/img-1.png"><br />
<img src="https://lh4.googleusercontent.com/-ny77OywB_Pk/Tqz2RrcVfCI/AAAAAAAAHnM/P2Awn0D79zc/s391/img-1.png" alt="asp.net mvc class library" /><br />
</a><br />
<p>The most important - it should contain Area Registration class inside. This is the one that suppose to register all router for your application:<br />
</p><pre class="brush: csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Web.Mvc;

namespace Sba.Web.Areas.Sales
{
 public class SalesAreaRegistration : AreaRegistration 
 {
  public override string AreaName
  {
   get 
   {
    return "Sales";
   }
  }

  public override void RegisterArea(AreaRegistrationContext context)
  {
            // All routes are here..

   context.MapRoute(
    "Sba_Sales",
    "sba/sales/{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = UrlParameter.Optional }
   );
  }
 }
}
</pre><p>That&#8217;s it. Now you implement Controller/Models in usual way and able to add unit tests project for new assembly.<br />
</p><p>Make sure that assembly will be placed into to Web Site <code>/Bin</code> folder. I simply added <code>../Site/Bin</code> as project output directory. At the site initialization and <code>Application_Start()</code> call of Global.asax, all <code>AreaRegistration</code> instances would be created and routes being registered.<br />
</p><h2>Views</h2><p>Views have to be placed in the Web Site folder itself. MVC has several rules for views placements, so you have to follow them. Views for controllers that are part of Area&#8217;s have to be places into <code>Site/Areas/AreaName/Views</code>, the common stuff line master pages are in <code>Site/Views/Shared</code>. It is very important that each View folder must contain the <code>web.config</code> inside. You can either pick it up from default MVC2 application of just grab from <a href="https://gist.github.com/1325577">gist</a>.<br />
</p><a href="https://lh3.googleusercontent.com/-1oPOjbGMkIA/Tqz2Rs4oS6I/AAAAAAAAHnE/_jP0yI97UZg/s313/img-3.png"><br />
<img src="https://lh3.googleusercontent.com/-1oPOjbGMkIA/Tqz2Rs4oS6I/AAAAAAAAHnE/_jP0yI97UZg/s313/img-3.png" alt="views folder structure" /><br />
</a><br />
<h2>IIS configuration</h2><p>Our application previously worked in &#8220;Classic&#8221; mode. Even thought, it is possible to run MVC on &#8220;Classic&#8221; I would not really recommend it to do and if production environment allows, just switch you application pool to &#8220;Integrated mode&#8221;.   <br />
</p><a href="https://lh6.googleusercontent.com/-cgYuQPO2v3o/Tqz2Rho34dI/AAAAAAAAHnI/jP_SfDVxFcY/s349/img-2.png"><br />
<img src="https://lh6.googleusercontent.com/-cgYuQPO2v3o/Tqz2Rho34dI/AAAAAAAAHnI/jP_SfDVxFcY/s349/img-2.png" alt="iis application pool config" /><br />
</a><br />
<p>After you did it, you can go and run you application. If you setup basic Home controller and view, you should be able to access it by given route. If you receiving 403 HTTP error check:<br />
</p><ul><li>Are you really on integrated mode?</li>
<li>Are there any physical folders that the same as you routing, e.g /sba/sales route and /site/sba/sales folder? In such case you either should correct the routing or change site folder structure.</li>
</ul><h2>Session is Null issue</h2><p>Moving along and starting implementation of some real controllers, we&#8217;ve got very strange <code>NullReferenceException</code> problem. After bit debugging it turned out that <code>HttpContext.Current.Session</code> is null in controller actions. That&#8217;s the common problem for legacy web sites. It is very well described in this <a href="http://stackoverflow.com/questions/218057/httpcontext-current-session-is-null-when-routing-requests">stackoverflow</a> answer. So, you just need to add one more section into <code>web.config</code> file.<br />
</p><pre class="brush: xml">&lt;configuration&gt;
  ...
  &lt;system.webServer&gt;
    ...
    &lt;modules&gt;
      &lt;remove name=&quot;Session&quot; /&gt;
      &lt;add name=&quot;Session&quot; type=&quot;System.Web.SessionState.SessionStateModule&quot;/&gt;
      ...
    &lt;/modules&gt;
  &lt;/system.webServer&gt;
&lt;/configuration&gt;
</pre><p>After all of those configuration changes your Web Site is fully adopted to ASP.NET MVC framework usage. So, just go ahead and feel the awesomeness of MVC!<br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/10/greg-young-and-rinat-abdulin-visited.html">
    
      Greg Young and Rinat Abdulin Visited Kyiv</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-10-25T09:47:00+03:00" pubdate data-updated="true">Oct 25<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/beerncode/'>BeerNCode</a>, <a class='category' href='/blog/categories/conference/'>Conference</a>, <a class='category' href='/blog/categories/ddd/'>DDD</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>It finally happened, <a href="http://codebetter.com/gregyoung/">Greg Young</a> and <a href="http://abdullin.com/">Rinat Abdulin</a> have been guesting Kyiv for almost the week. <br />
</p><p>Initially we&#8217;ve gathered on <a href="http://kyivbeerncode.org/">Beer && Code</a> meeting. The format a little changed that time, but I would say that was really interesting meeting. Greg introduced one of the project he currently working on <a href="http://continuoustests.com/">http://continuoustests.com/</a> that now referenced as &#8220;Mighty Moose&#8221;. &#8220;Mighty Moose&#8221; appear to be really powerful tool that tracks both code and tests changes, and in case of changes taking place it automatically re-runs all related test cases. So, we&#8217;ve grabbed the latest version on MM and played with it a bit. MM is officially in betta now and gonna to be release soon, so did a small contribution by submitting some bugs found on a fly. I also really much enjoyed the quick demonstration of <a href="https://github.com/gregoryyoung/Simple.Testing">Simple.Testing</a> framework. It worth to have a separate blog post on that, but in short - it is BDD style framework that literally produce plain English specifications as it&#8217;s output. It&#8217;s indeed very simple - just several hundreds LOC&#8217;s, but very impressive.<br />
</p><p>But of cause, the main event was <a href="http://www.facebook.com/event.php?eid=268332313185736">Free Event Centric Weekend</a>. It is very hard to describe what was there just in this short post. You might check out some tweets on <a href="http://twitter.com/#!/search/eventcentric">#eventcentric</a> channel. Greg and Rinat were sharing their huge experience on CQRS/DDD and I would say that was extremely interesting. I&#8217;m not using either CQRS or DDD on my daily work, so a lot of new concept&#8217;s I&#8217;ve heard are still really unknown to me, but I&#8217;m happy I looked behind the curtain. Greg is <a href="http://martinfowler.com/bliki/ShuHaRi.html">Ri</a> level developer - he is simply breaking the concepts. Seriously, I was blown away with some of the statements and my brain is still &#8220;damaged&#8221; with everything I heard there.<br />
</p><a href="https://lh4.googleusercontent.com/-_2de-YNoo-0/TqZWzXugX3I/AAAAAAAAHm0/_zNc09RHImQ/s720/eventcentic.jpg"><br />
<img src="https://lh4.googleusercontent.com/-_2de-YNoo-0/TqZWzXugX3I/AAAAAAAAHm0/_zNc09RHImQ/s720/eventcentic.jpg" alt="Eventcentric meeting in Kyiv" style="width: 620px" /><br />
</a><br />
<p>Besides of that we had several cool evenings, drinking beers. I would say that was great week and I&#8217;m really happy to meet you guys. I would also say big thanks to <a href="http://kievalt.net/">KievAltNet</a>, <a href="http://www.luxoft.com/">Luxoft</a> with support they provided to make this happen. I know this in not your last visit to Kiev, so see you soon! <br />
</p><p>ps. As more you know as more unknown you are able to see&#8230;<br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  
    <article>
        
  <h1 class="title pure-u-1">
    
    <a href="/2011/10/network-conference-in-kharkiv.html">
    
      NETWork Conference in Kharkiv</a>
  </h1>

  <div class="meta pure-u-1-5">
    <div class="date icon-calendar">








  


<time datetime="2011-10-16T16:55:00+03:00" pubdate data-updated="true">Oct 16<span>th</span>, 2011</time></div>
    <div class="tags icon-tag-2">

<span class="categories">
  
    <a class='category' href='/blog/categories/conference/'>Conference</a>
  
</span>

</div>
  </div>

  <div class="entry-content pure-u-4-5">
    <div class="content">
      <div class='post'>
<p>In short, it was one of the most exciting and interesting conferences I ever been (and participated) so far. My big respect goes to organizers: <a href="http://sigmaukraine.com/">Sigma Ukraine</a>, <a href="http://www.akvelon.com.ua/">Akvelon</a> and <a href="http://ciklum.net/">Ciklum</a> as main sponsor. <br />
</p><p>In a little long, I&#8217;ve been invited to participate this conference by <a href="http://www.facebook.com/anastasiakladova">Anastasia Kladova</a>, the PR manager of <a href="http://sigmaukraine.com/">Sigma Ukraine</a> during my visit of <a href="http://www.beletsky.net/2011/08/it-jam-2011-in-odessa_23.html">IT Jam 2011</a> this summer. It sounded so cool to me, since so famous guys as <a href="http://network-ua.com/speaker/ayende-rahien-aka-oren-eini/">Ayende</a>, <a href="http://network-ua.com/speaker/greg-young/">Greg Young</a> and <a href="http://network-ua.com/speaker/rinat-abdullin/">Rinat Abdulin</a> would be the speakers there as well. I had not other choice, just to agree.<br />
</p><p>Well, my trip to Kharkiv started not very good. Due to my personal awkwardness I simply missed the train. Now I have fun of that fact, by then I was standing on station and seeing my train passing away - it was not so fun to me. Anyway, with great advice of <a href="">@chaliy</a> by phone I switched to another train. The one one problem was - it comes to Kharkiv pretty late, at 10.00 o&#8217;clock.<br />
</p><p>Unfortunately I missed first keynote by <a href="http://network-ua.com/speaker/sander-hoogendorn/">Sander</a> and first session of speeches. But I was ready for the rest of the day. I would not describe long my feelings to meet colleagues from other cities, which we communicate thought twitter. But it is exactly the conferences like that, where we have real opportunity to talk to each other. As for me, such communication is a bigger asset of any conference including NETWork.<br />
</p><a href="https://lh6.googleusercontent.com/-kH4mZBDxBug/Tp2QkwVhZ1I/AAAAAAAAHmo/DRX7IEoA1pI/s720/DSC_2356.JPG"><br />
<img src="https://lh6.googleusercontent.com/-kH4mZBDxBug/Tp2QkwVhZ1I/AAAAAAAAHmo/DRX7IEoA1pI/s720/DSC_2356.JPG" /><br />
</a><br />
<p>Let me share some feedback I got about the speeches I visited:<br />
</p><ul><li><br />
<strong>CQRS AND EVENT SOURCING</strong> by <a href="http://network-ua.com/speaker/greg-young/">Greg Young</a> - I really much enjoyed the that speech. Doesn&#8217;t matter I&#8217;ve seen it before on video :) - still I was amazed about his speakers skill and energy he exposed towards the audience. His mimic, body language and personal behavior - made the speech really attractive. I would not say I heard something really new to me, but at least I improved some knowledge I already had.<br />
</li>
<li><br />
<strong>APPLIED CODE GENERATION IN .NET</strong> by <a href="http://network-ua.com/speaker/dmitro-mindra/">Dmitry Mindra</a> - great talk about Code Generation in .NET application. Even, if I dislike code generation much, Dmitry managed to find good Pros. and Cons. of code generation. So, at the end of the speech I even was not possible to start holy war on that topic, since really strong facts he had.<br />
</li>
<li><br />
<strong>INSIDE ASP.NET MVC FRAMEWORK</strong> be me - yeah, that&#8217;s my speech so I&#8217;m not really happy as usual. Again, I didn&#8217;t fit everything I wanted to say. Something that I did seems was not really clear and far away from comprehensive. It would be last attempt I do that &#8216;Inside MVC&#8217; talk - it is simply too big, so probably next time I just select one small topic and focus on that. Anyway, I all the time enjoy the speaking and I really like that feeling of stress before and relax after :).  <br />
</li>
<li><br />
<strong>NOSQL  A CHANGE OF PERSPECTIVE FOR THE DEVELOPER OF TODAY</strong> by <a href="http://network-ua.com/speaker/ayende-rahien-aka-oren-eini/">Ayende</a> - I have a split decision on that. The beginning of the speech was simply boring, I don&#8217;t understand the reason of spending 0.5h do describe the difference of price of 1 Mb HDD in 80&#8217;s and 00&#8217;s. Moreover, due to Ayende&#8217;s accent sometimes I just missed the idea. The end of the speech were more exiting but still I was disappointed. Ayende is great developer, everybody knows that - but it was not even one small example of code working with RavenDB. Probably he left it for some practical session, but still I think it is kind of drawback of his presentation.<br />
</li>
</ul><p>And after all speeches we had a kind of Round Table. All speaker got on stage and answering the questions of audience. It was a little funny to me how it went. First, the language - some questions were in English but answered in Russian, some was Russian but answered English :). I actually used English in respect towards our foreign guests, but anyway. The answers were long, not exact and mainly loosing the point of original question. I think the moderation (with a timing and topics) is really important here. <br />
</p><p>What I remembered the most is the question to Ayende - &#8220;How you became so productive?&#8221;, and the answer was something that great developer should answer &#8220;I&#8217;m not so productive, I just code a lot and do some blog posts&#8221;. Yeah, &#8220;Code a lot&#8221; - so simple rule to became from good to great. I&#8217;ll remember that.<br />
</p><p>Finally we had a great dinner at the one of Kharkiv&#8217;s restaurant&#8217;s. And I went to train station (0.5 hours ahead). There I met my guys from <a href="http://kievalt.net/">Kiev ALT.NET</a> who had a great mood and bag full of beer. So, we&#8217;ve had nice Beer && Talk session till 3.00 AM on our way back home. <br />
</p></div>

      
      
    </div>
  </div>

    </article>
  
  <div class="pagination inner pure-u-1">
    
      <a class="prev" href="/blog/page/11/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/9/">Newer &rarr;</a>
    
  </div>
</div></div>
	<footer class="pure-g-r"><div class="inner pure-u-1">
	<p>
		Theme by <a href="https://twitter.com/alexbeletsky">@alexbeletsky</a> | Fonts by <a href="http://www.google.com/fonts/">Google Fonts</a> | Icons by <a href="http://fontello.com/">Fontello</a> | Hosted on <a href="http://github.com">github</a> | Powered by <a href="http://octopress.org/">Octopress</a>
	</p>
	<p>
		Copyright  2010 - 2013 beletsky.net
	</p>
</div>

</footer>
	<div class="buttons">
	


	
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


	
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


	
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


	

</div>
</body>
</html>